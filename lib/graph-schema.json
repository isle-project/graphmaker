{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Graph Schema",
  "description": "Describes objects that define graphs with optional attributes on nodes and/or edges. Directed and undirected graphs are supported, as well as graphs with self-loops and multiple edges between nodes.",
  "type": "object",
  "$defs": {
    "x": {
      "type": "number",
      "description": "x-coordinate (left boundary of canvas is zero, right boundary is one)"
    },
    "y": {
      "type": "number",
      "description": "y-coordinate (lower boundary of canvas is zero, upper boundary is one)"
    },
    "z": {
      "type": "number",
      "description": "z-index"
    },
    "nodeShape": {
      "enum": [
        "circle",
        "square",
        "diamond",
        "triangle",
        "ellipse",
        "rectangle"
      ],
      "default": "circle"
    },
    "cardinalDirection": {
      "enum": [
        "north",
        "northeast",
        "east",
        "southeast",
        "south",
        "southwest",
        "west",
        "northwest",
        "left",
        "right",
        "up",
        "down",
        "upper-left",
        "upper-right",
        "lower-left",
        "lower-right"
      ],
      "description": "Cardinal direction"
    },
    "nodeWidthToHeight": {
      "type": "number",
      "description": "Aspect ratio of node's width to height",
      "default": 1
    },
    "nodeSize": {
      "type": "number",
      "description": "Size of the node's shape",
      "default": 1
    },
    "label": {
      "type": "string",
      "description": "Text label"
    },
    "style": {
      "type": "string",
      "description": "Style name",
      "default": "default"
    },
    "fontSize": {
      "type": "number",
      "description": "Font size in points",
      "default": 12
    },
    "fontFamily": {
      "anyOf": [
        {
          "enum": [
            "Times New Roman",
            "Comic Sans MS",
            "Courier New",
            "Gill Sans",
            "Trebuchet MS"
          ],
          "description": "Fuzzy match user-requested font families."
        },
        {
          "type": "string",
          "description": "Other font families"
        }
      ],
      "description": "Font family"
    },
    "fontStyle": {
      "enum": [
        "normal",
        "italic",
        "oblique"
      ],
      "description": "Font style"
    },
    "fontWeight": {
      "enum": [
        "normal",
        "bold",
        "bolder",
        "lighter",
        "100",
        "200",
        "300",
        "400",
        "500",
        "600",
        "700",
        "800",
        "900"
      ],
      "description": "Font weight"
    },
    "fontVariant": {
      "enum": [
        "normal",
        "small-caps",
        "titling-caps"
      ],
      "description": "Font variant"
    },
    "fontColor": {
      "type": "string",
      "description": "A HEX color or RGB color such as rgb(255,255,255) for the font"
    },
    "textAnchor": {
      "enum": [
        "start",
        "middle",
        "end"
      ],
      "description": "Text anchor"
    },
    "lineColor": {
      "type": "string",
      "description": "A HEX color or RGB color such as rgb(255,255,255) for the stroke"
    },
    "lineWidth": {
      "enum": [
        "very-thin",
        "thin",
        "medium",
        "thick",
        "very-thick"
      ],
      "description": "Line width"
    },
    "lineStyle": {
      "enum": [
        "solid",
        "dashed",
        "dotted"
      ],
      "description": "Line stroke style"
    },
    "arrowStyle": {
      "enum": [
        "light",
        "normal",
        "heavy",
        "double"
      ],
      "description": "Arrow style"
    },
    "fillStyle": {
      "description": "Styling for the fill pattern of the shape",
      "oneOf": [
        {
          "enum": [
            "solid",
            "dotted",
            "hashed",
            "crosshatched"
          ]
        },
        {
          "type": "array",
          "minItems": 1,
          "maxItems": 3,
          "items": [
            {
              "const": "dotted"
            },
            {
              "type": "number",
              "minimum": 0,
              "description": "Size of the dots in pixels"
            },
            {
              "type": "number",
              "minimum": 1,
              "maximum": 100,
              "description": "Pixels per dot in both horizontal and vertical directions"
            }
          ]
        },
        {
          "type": "array",
          "minItems": 1,
          "maxItems": 3,
          "items": [
            {
              "const": "hashed"
            },
            {
              "enum": [
                "vertical",
                "horizontal",
                "increasing",
                "decreasing"
              ],
              "default": "increasing"
            },
            {
              "type": "number",
              "description": "Thickness of the hashing lines"
            }
          ]
        },
        {
          "type": "array",
          "minItems": 1,
          "maxItems": 3,
          "items": [
            {
              "const": "crosshatched"
            },
            {
              "enum": [
                "vertical",
                "diagonal"
              ],
              "default": "vertical"
            },
            {
              "type": "number",
              "description": "Thickness of the cross-hatching lines"
            }
          ]
        }
      ]
    },
    "fillColor": {
      "type": "string",
      "description": "A HEX color or RGB color such as rgb(255,255,255) to fill a shape"
    },
    "offset": {
      "description": "Represents an offset from a position",
      "oneOf": [
        {
          "const": "none"
        },
        {
          "$ref": "#/$defs/cardinalDirection"
        },
        {
          "type": "array",
          "description": "Offset in the given cardinal direction",
          "minItems": 2,
          "maxItems": 2,
          "items": [
            {
              "$ref": "#/$defs/cardinalDirection"
            },
            {
              "type": "number",
              "description": "Distance from the position"
            }
          ]
        },
        {
          "type": "array",
          "description": "Offset in cartesian coordinates (0-1)",
          "minItems": 2,
          "maxItems": 2,
          "items": {
            "type": "number"
          }
        },
        {
          "type": "array",
          "minItems": 3,
          "maxItems": 3,
          "items": [
            {
              "const": "polar"
            },
            {
              "type": "number",
              "description": "Angle in degrees"
            },
            {
              "type": "number",
              "description": "Distance from the position",
              "minimum": 0
            }
          ]
        }
      ]
    }
  },
  "properties": {
    "directed": {
      "type": "boolean",
      "description": "`true` if it is a directed graph, `false` for undirected graphs (a graph is directed if it has any directed edges)"
    },
    "canvas": {
      "type": "object",
      "description": "canvas configuration",
      "properties": {
        "width": {
          "type": "number",
          "description": "width of the canvas in pixels",
          "default": 500
        },
        "height": {
          "type": "number",
          "description": "height of the canvas in pixels",
          "default": 500
        }
      }
    },
    "styles": {
      "type": "object",
      "description": "mapping from style names to style definition objects",
      "additionalProperties": {
        "type": "object",
        "description": "style definition objects mapping style attribute names to values",
        "properties": {
          "nodeShape": {
            "$ref": "#/$defs/nodeShape"
          },
          "nodeWidthToHeight": {
            "$ref": "#/$defs/nodeWidthToHeight"
          },
          "nodeSize": {
            "$ref": "#/$defs/nodeSize"
          },
          "lineColor": {
            "$ref": "#/$defs/lineColor"
          },
          "lineWidth": {
            "$ref": "#/$defs/lineWidth"
          },
          "lineStyle": {
            "$ref": "#/$defs/lineStyle"
          },
          "arrowStyle": {
            "$ref": "#/$defs/arrowStyle"
          },
          "fillColor": {
            "$ref": "#/$defs/fillColor"
          },
          "fontFamily": {
            "$ref": "#/$defs/fontFamily"
          },
          "fontSize": {
            "$ref": "#/$defs/fontSize"
          },
          "fontStyle": {
            "$ref": "#/$defs/fontStyle"
          },
          "fontWeight": {
            "$ref": "#/$defs/fontWeight"
          },
          "fontVariant": {
            "$ref": "#/$defs/fontVariant"
          },
          "fontColor": {
            "$ref": "#/$defs/fontColor"
          },
          "labelAnchor": {
            "$ref": "#/$defs/textAnchor"
          }
        }
      }
    },
    "constraints": {
      "type": "array",
      "description": "Array of positioning constraints on node (x,y) coordinates of the nodes, where (0,0) is the bottom-left point of the canvas, with x-coordinates increasing to the right and y-coordinates increasing to the top. Positioning requests for the nodes should be treated as requests for corresponding constraints on the node positions.",
      "default": [],
      "items": {
        "type": "object",
        "description": "A positioning constraint on node (x,y) coordinates",
        "properties": {
          "meaning": {
            "type": "string",
            "description": "A description of the constraint",
            "default": ""
          },
          "constraints": {
            "type": "array",
            "items": {
              "type": "string",
              "description": "A linear equation or inequality on the coordinates of a node in terms of the node names. Node names have to be enclosed by single quotes. Operators * / + - are supported. This string must not contain parentheses.",
              "examples": [
                "'A'.x + 'B'.x = 0",
                "2.1 'F'.x + 3 'G'.x - 4 'H'.x = 17",
                "'node1'.x / 3 + 'node2'.x / 3 + 'node3'.x / 3 = 'node4'.x",
                "'node7.y - 13 node8.y = 4",
                "'A'.x + 'B'.y = 'C'.x + 'D'.y",
                "'C'.y - 'D'.y <= 0",
                "'A'.y - 'B'.x >= 0",
                "1.1 'U'.x - 3.2 'V'.x <= 0",
                "1.1 'U'.y - 3.2 'V'.y <= 0"
              ]
            }
          }
        },
        "additionalProperties": false,
        "examples": [
          {
            "meaning": "Node A is to the left of node B",
            "constraints": ["'A'.x <= 'B'.x"]
          },
          {
            "meaning": "Node C is above node D",
            "constraints": ["'C'.y >= 'D'.y"]
          },
          {
            "meaning": "Nodes U and V are at the same height",
            "constraints": ["'U'.y = 'V'.y"]
          },
          {
            "meaning": "Node C is at the midpoint of nodes A and B",
            "constraint": [
              "'C'.x = ('A'.x + 'B'.x) / 2",
              "'C'.y = ('A'.y + 'B'.y) / 2"
            ]
          },
          {
            "meaning": "Nodes A, B, C are at the same horizontal position",
            "constraints": [
              "'A'.x = 'B'.x'",
              "'B'.x = 'C'.x"
            ]
          }
        ]
      }
    },
    "nodes": {
      "type": "object",
      "description": "mapping from node names to an attribute object",
      "additionalProperties": {
        "type": "object",
        "description": "maps an attribute name to an attribute value",
        "properties": {
          "shape": {
            "$ref": "#/$defs/nodeShape",
            "default": "circle"
          },
          "widthToHeight": {
            "$ref": "#/$defs/nodeWidthToHeight",
            "default": 1
          },
          "size": {
            "$ref": "#/$defs/nodeSize",
            "default": 1
          },
          "label": {
            "$ref": "#/$defs/label"
          },
          "labelOffset": {
            "$ref": "#/$defs/offset"
          },
          "x": {
            "$ref": "#/$defs/x"
          },
          "y": {
            "$ref": "#/$defs/y"
          },
          "z": {
            "$ref": "#/$defs/z"
          },
          "style": {
            "$ref": "#/$defs/style"
          },
          "lineColor": {
            "$ref": "#/$defs/lineColor"
          },
          "fillColor": {
            "$ref": "#/$defs/fillColor"
          },
          "fillStyle": {
            "$ref": "#/$defs/fillStyle"
          },
          "lineWidth": {
            "$ref": "#/$defs/lineWidth"
          },
          "lineStyle": {
            "$ref": "#/$defs/lineStyle"
          },
          "fontSize": {
            "$ref": "#/$defs/fontSize"
          },
          "fontFamily": {
            "$ref": "#/$defs/fontFamily"
          },
          "fontColor": {
            "$ref": "#/$defs/fontColor"
          },
          "fontStyle": {
            "$ref": "#/$defs/fontStyle"
          },
          "fontVariant": {
            "$ref": "#/$defs/fontVariant"
          },
          "fontWeight": {
            "$ref": "#/$defs/fontWeight"
          },
          "labelAnchor": {
            "$ref": "#/$defs/textAnchor"
          }
        },
        "additionalProperties": false
      }
    },
    "adjacency": {
      "type": "object",
      "description": "mapping from node names to an array of objects holding the name of the node to which the edge is connected and the name of the edge",
      "additionalProperties": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "targetNode": {
              "type": "string",
              "description": "name of the node to which the edge is connected"
            },
            "edge": {
              "type": "string",
              "description": "name of the edge (must be present in the edges object of the graph)"
            }
          }
        }
      }
    },
    "edges": {
      "type": "object",
      "description": "mapping from edge names to an attribute object; by default, an edge from node A to node B is named AB",
      "additionalProperties": {
        "type": "object",
        "description": "maps an attribute name to an attribute value",
        "properties": {
          "label": {
            "$ref": "#/$defs/label"
          },
          "weight": {
            "type": "number",
            "description": "An optional numeric value associated with the edge."
          },
          "labelOffset": {
            "$ref": "#/$defs/offset"
          },
          "weightOffset": {
            "$ref": "#/$defs/offset"
          },
          "z": {
            "$ref": "#/$defs/z"
          },
          "style": {
            "$ref": "#/$defs/style"
          },
          "angleLeaving": {
            "type": "number",
            "description": "angle relative to the direction between the node centers; in undirected graphs, the node whose name is first lexographically is taken as the source for this purpose.",
            "default": 0
          },
          "angleEntering": {
            "type": "number",
            "description": "angle relative to the direction between the node centers; in undirected graphs, the node whose name is second lexographically is taken as the target for this purpose.",
            "default": 0
          },
          "softnessLeaving": {
            "type": "number",
            "description": "controls the curvature of an edge near the source node",
            "default": 0.5
          },
          "softnessEntering": {
            "type": "number",
            "description": "controls the curvature of an edge near the target node",
            "default": 0.5
          },
          "lineColor": {
            "$ref": "#/$defs/lineColor"
          },
          "arrowStyle": {
            "$ref": "#/$defs/arrowStyle"
          },
          "lineWidth": {
            "$ref": "#/$defs/lineWidth"
          },
          "lineStyle": {
            "$ref": "#/$defs/lineStyle"
          },
          "fontSize": {
            "$ref": "#/$defs/fontSize"
          },
          "fontFamily": {
            "$ref": "#/$defs/fontFamily"
          },
          "fontColor": {
            "$ref": "#/$defs/fontColor"
          },
          "fontStyle": {
            "$ref": "#/$defs/fontStyle"
          },
          "fontVariant": {
            "$ref": "#/$defs/fontVariant"
          },
          "fontWeight": {
            "$ref": "#/$defs/fontWeight"
          },
          "labelAnchor": {
            "$ref": "#/$defs/textAnchor"
          }
        },
        "additionalProperties": false
      }
    },
    "definitions": {
      "type": "object",
      "description": "aliases for the constructs used in style definitions"
    },
    "decorations": {
      "type": "array",
      "description": "Array of decorations to display on top of the graph (texts and rectangles)",
      "items": {
        "type": "object",
        "required": [
          "type",
          "x",
          "y"
        ],
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "text",
              "region"
            ],
            "description": "The type of decoration"
          },
          "x": {
            "$ref": "#/$defs/x"
          },
          "y": {
            "$ref": "#/$defs/y"
          },
          "z": {
            "$ref": "#/$defs/z"
          },
          "style": {
            "$ref": "#/$defs/style"
          },
          "fillColor": {
            "$ref": "#/$defs/fillColor"
          },
          "lineColor": {
            "$ref": "#/$defs/lineColor"
          },
          "lineWidth": {
            "$ref": "#/$defs/lineWidth"
          },
          "lineStyle": {
            "$ref": "#/$defs/lineStyle"
          },
          "fontSize": {
            "$ref": "#/$defs/fontSize"
          },
          "fontFamily": {
            "$ref": "#/$defs/fontFamily"
          },
          "text": {
            "type": "string",
            "description": "Text overlay"
          },
          "region": {
            "type": "array",
            "description": "Relative width and height of a rectangle (as a proportion of the canvas dimensions)",
            "maxItems": 2,
            "minItems": 2,
            "items": {
              "type": "number"
            }
          }
        },
        "dependencies": {
          "type": {
            "oneOf": [
              {
                "properties": {
                  "type": {
                    "enum": [
                      "text"
                    ]
                  }
                },
                "required": [
                  "text"
                ]
              },
              {
                "properties": {
                  "type": {
                    "enum": [
                      "region"
                    ]
                  }
                },
                "required": [
                  "region"
                ]
              }
            ]
          }
        }
      }
    }
  },
  "required": [
    "directed",
    "nodes",
    "edges",
    "adjacency"
  ],
  "additionalProperties": false
}
